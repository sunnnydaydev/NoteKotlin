# é›†åˆ

## æ¦‚è¿°

kotlinçš„é›†åˆå’Œjavaçš„ç¨å¾®æœ‰äº›åŒºåˆ«ï¼Œjavaä¸­å£°æ˜ä¸€ä¸ªé›†åˆåè¾¹å¯è½»æ¾å®ç°å¢åˆ æ“ä½œï¼Œkotlinä¾¿ä¸æ˜¯è¿™æ ·ï¼Œkotlinä¸­åˆ†ä¸ºå¯å˜é›†åˆã€ä¸å¯å˜é›†åˆã€‚

kotlinä¸­ Listã€Setã€Mapæ¥å£éƒ½æ˜¯ä¸å¯å˜çš„è¿™æ„å‘³ç€æˆ‘ä»¬å¯¹é›†åˆåªæœ‰è¯»çš„æƒé™æ— å†™çš„æƒé™ï¼Œæƒ³è¦æœ‰å†™çš„æƒé™å°±è¦ å£°æ˜ æˆ– è½¬ä¸º å¯å˜é›†åˆã€‚

Listã€Setã€Mapéƒ½ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä»¥Listä¸¾ä¸ªä¾‹å­

```kotlin
fun main() {

    val list4 = listOf("1", "2") //listOfä¸ºä¸å¯å˜é›†åˆ
    val list1 = arrayListOf("1")  // ArrayListå¯å˜é›†åˆ

    val list2: List<String> = list1// è½¬ä¸ºListæ¥å£åä¸å¯å˜ã€‚list2 ä¸å…·æœ‰ add removeæ“ä½œ
    val list3: MutableList<String> = list2 as MutableList<String>// è½¬ä¸ºMutableListæ¥å£åå¯å˜

}
```

å¯è§æƒ³è¦è½¬æ¢åªéœ€è¦ä¾èµ–Listå’ŒMutableListæ¥å£å°±è¡Œå•¦ã€‚

# åˆ›å»ºé›†åˆ

é€šè¿‡ç³»ç»Ÿæä¾›çš„æ ‡å‡†åº“èƒ½å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºé›†åˆ

- listOf<T>()
- setOf<T>()
- mutableListOf<T>()
- mutableSetOf<T>()
- mapOf<K,V>()
- mutableMapOf<K,V>()

- emptyList()
- emptySet()
- emptyMap()

```kotlin
fun main() {
    val listOf1 = listOf<String>()
    val listOf2 = listOf("1", "2")

    val set = setOf("1", "2")
    val mutableListOf = mutableListOf("1", "2")
    val mutableSetOf = mutableSetOf("1", "2")

    val pair1 = Pair(first = "name", second = "Carry")
    val pair2 = Pair(first = "name", second = "Carry")
    val mapOf1 = mapOf(pair1, pair2)
    val mapOf2 = mapOf("name" to "Carry")
    val mutableMapOf = mutableMapOf("name" to "Carry")
    val mutableMapOf1 = mutableMapOf<String, String>().apply {
        this["name"] = "Carry"
    }

    val emptyList = emptyList<String>()
    val emptySet = emptySet<String>()
    val emptyMap = emptyMap<String, String>()


    val arrayList = arrayListOf("1", "2")
    val arrayList2 = arrayListOf<Int>() // empty arrayList
}
```

æ³¨æ„å‡ ç‚¹ï¼š

- ä»¥é€—å·åˆ†éš”çš„é›†åˆå…ƒç´ åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ£€æµ‹å…ƒç´ ç±»å‹ã€‚
- åˆ›å»ºç©ºé›†åˆæ—¶ï¼Œé¡»æ˜ç¡®æŒ‡å®šç±»å‹ã€‚
- mapä¸­å­˜çš„æ˜¯Pairå¯¹è±¡ï¼Œé€šå¸¸ä½¿ç”¨ä¸­ç¼€å‡½æ•° to åˆ›å»ºã€‚to ç¬¦å·åˆ›å»ºäº†ä¸€ä¸ªçŸ­æ—¶å­˜æ´»çš„ Pair å¯¹è±¡ï¼Œå› æ­¤å»ºè®®ä»…åœ¨æ€§èƒ½ä¸é‡è¦æ—¶æ‰ä½¿ç”¨å®ƒã€‚ ä¸ºé¿å…è¿‡å¤šçš„å†…å­˜
  ä½¿ç”¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–æ–¹æ³•ã€‚å¦‚å€ŸåŠ©applyå‡½æ•°ã€‚

# é›†åˆçš„å¤åˆ¶

è¦åˆ›å»ºä¸ç°æœ‰é›†åˆå…·æœ‰ç›¸åŒå…ƒç´ çš„é›†åˆï¼Œå¯ä»¥ä½¿ç”¨å¤åˆ¶æ“ä½œã€‚æ ‡å‡†åº“ä¸­çš„é›†åˆå¤åˆ¶æ“ä½œåˆ›å»ºäº†å…·æœ‰ç›¸åŒå…ƒç´ å¼•ç”¨çš„ æµ… å¤åˆ¶é›†åˆã€‚ å› æ­¤ï¼Œå¯¹é›†åˆå…ƒç´ æ‰€åšçš„æ›´æ”¹ä¼š
åæ˜ åœ¨å…¶æ‰€æœ‰å‰¯æœ¬ä¸­ã€‚

åœ¨ç‰¹å®šæ—¶åˆ»é€šè¿‡é›†åˆå¤åˆ¶å‡½æ•°ï¼Œä¾‹å¦‚toList()ã€toMutableList()ã€toSet() ç­‰ç­‰ã€‚åˆ›å»ºäº†é›†åˆçš„å¿«ç…§ã€‚ ç»“æœæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰ç›¸åŒå…ƒç´ çš„æ–°é›†åˆ å¦‚æœåœ¨æº
é›†åˆä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œåˆ™ä¸ä¼šå½±å“å‰¯æœ¬ã€‚å‰¯æœ¬ä¹Ÿå¯ä»¥ç‹¬ç«‹äºæºé›†åˆè¿›è¡Œæ›´æ”¹ã€‚

```kotlin
fun main() {
    val mutableListOf = mutableListOf("init")
    val toList = mutableListOf.toMutableList()

    /**
     * éªŒè¯å†…å­˜åœ°å€ä¸€è‡´
     * listOf1:3237167
     * toList:3237167
     * */
    println("listOf1:${mutableListOf.hashCode()}")
    println("toList:${toList.hashCode()}")

    /**
     * éªŒè¯ä½¿ç”¨ktç±»åº“æä¾›çš„apiåˆ›å»ºçš„å‰¯æœ¬ï¼Œé’ˆå¯¹å‰¯æœ¬æ“ä½œä¸ä¼šå½±å“æºé›†åˆ
     * mutableListOf:initã€mutableListOf:1
     * toList:initã€toList:2
     * */
    mutableListOf.add("1")
    toList.add("2")
    mutableListOf.forEach {
        println("mutableListOf:${it}")
    }
    toList.forEach {
        println("toList:${it}")
    }

    /**
     * éªŒè¯åŸå§‹çš„å¼•ç”¨èµ‹å€¼æ–¹å¼åˆ›å»ºçš„å‰¯æœ¬é’ˆå¯¹å‰¯æœ¬ä¿®æ”¹ä¼šå½±å“æºé›†åˆ
     * mutableListOf1:initã€mutableListOf1:1
     * */
    val mutableListOf1 = mutableListOf("init")
    val mutableListOf2 = mutableListOf1
    mutableListOf2.add("1")
    mutableListOf1.forEach {
        println("mutableListOf1:${it}")
    }

}
```

# é›†åˆçš„è¿­ä»£

Iteratoræ˜¯åŸºç±»æ¥å£ï¼Œå®šä¹‰äº†å¦‚ä¸‹è§„èŒƒï¼š

```kotlin
public interface Iterator<out T> {
    /**
     * è·å–å½“å‰å…ƒç´ ï¼Œå¹¶å°†æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€å…ƒç´ ã€‚
     * */
    public operator fun next(): T

    /**
     * æ˜¯å¦å­˜åœ¨ä¸‹ä¸€ä¸ªå…ƒç´ 
     * */
    public operator fun hasNext(): Boolean
}
```

ListIterator æ‰©å±•äº†åŸºç±»æ”¯æŒåˆ—è¡¨çš„åŒå‘è¿­ä»£ï¼š

```kotlin
public interface ListIterator<out T> : Iterator<T> {
    // Query Operations
    override fun next(): T
    override fun hasNext(): Boolean

    /**
     * Returns `true` if there are elements in the iteration before the current element.
     */
    public fun hasPrevious(): Boolean

    /**
     * Returns the previous element in the iteration and moves the cursor position backwards.
     */
    public fun previous(): T

    /**
     * Returns the index of the element that would be returned by a subsequent call to [next].
     */
    public fun nextIndex(): Int

    /**
     * Returns the index of the element that would be returned by a subsequent call to [previous].
     */
    public fun previousIndex(): Int
}
```
MutableIteratoræ‰©å±•äº†Iteratorå¯ä»¥åœ¨è¿­ä»£æ—¶å¢ã€åˆ ã€æ›´æ–°å…ƒç´ ï¼š

```kotlin
public interface MutableListIterator<T> : ListIterator<T>, MutableIterator<T> {
    // Query Operations
    override fun next(): T
    override fun hasNext(): Boolean

    // Modification Operations
    override fun remove(): Unit

    /**
     * Replaces the last element returned by [next] or [previous] with the specified element [element].
     */
    public fun set(element: T): Unit

    /**
     * å½“å‰å…ƒç´ ä¹‹å‰æ’å…¥æ–°çš„å…ƒç´ ã€‚
     */
    public fun add(element: T): Unit
}
```

å¦‚ä½•è·å–å¯å˜é›†åˆè¿­ä»£å™¨å‘¢ï¼Ÿå¾ˆç®€å•å¯å˜é›†åˆç›´æ¥è°ƒç”¨apiå³å¯ã€‚

```kotlin
    val iterableList  =  listOf("1","2","3")
    val  iterator = iterableList.toMutableList().listIterator()
```

```kotlin
    val iterableList  =  listOf("1","2","3")
    val  iterator = iterableList.toMutableList().listIterator()
     iterator.next() //é»˜è®¤å½“å‰å…ƒç´ ä¸ºé¦–ä¸ªå…ƒç´ ï¼Œè°ƒç”¨nextåå½“å‰å…ƒç´ æŒ‡å‘"2"
     iterator.add("test") // æ­¤æ—¶é›†åˆä¸º"1","test"ï¼Œ"2","3",å½“å‰å…ƒç´ è¿˜æ˜¯æŒ‡å‘"2"
     println("current:${iterator.next()}") //æ­¤æ—¶åº”æ‰“å°"2",ç„¶åå½“å‰å…ƒç´ æŒ‡å‘3

log ->
current:2
```

# åºåˆ—

å›é¡¾ä¸‹é›†åˆçš„mapæ“ä½œï¼Œå…¶å®mapæ˜¯Iterableçš„ä¸€ä¸ªæ‰©å±•å‡½æ•° ->

```kotlin
public inline fun <T, R> Iterable<T>.map(transform: (T) -> R): List<R> {
    return mapTo(ArrayList<R>(collectionSizeOrDefault(10)), transform)
}
```

åºåˆ—Sequence<T>æä¾›äº†ä¸Iterable<T>ç›¸åŒçš„å‡½æ•°ï¼Œä½†å®ç°å¦ä¸€ç§æ–¹æ³•æ¥è¿›è¡Œ å¤šæ­¥éª¤ é›†åˆå¤„ç†ã€‚


###### 1ã€åºåˆ—çš„åˆ›å»º

ï¼ˆ1ï¼‰é€šè¿‡api sequenceOf

ï¼ˆ2ï¼‰é€šè¿‡Iterableï¼ˆListæˆ–setï¼‰å¯¹è±¡çš„api asSequence

ï¼ˆ3ï¼‰generateSequence api

ï¼ˆ4ï¼‰sequence{}

åä¸¤ç§åˆ›å»ºæ–¹å¼ä½¿ç”¨è¾ƒå°‘ï¼Œå¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£äº†è§£ä¸‹~

###### 2ã€åºåˆ—ä¸é›†åˆçš„åŒºåˆ«

é›†åˆæ‰§è¡Œä¸€äº›åˆ—æ“ä½œæ—¶ï¼šä¼šä¾æ¬¡æ‰§è¡Œæ¯ä¸ªæ­¥éª¤åŒæ—¶è·å–åˆ°æ­¥éª¤æ‰§è¡Œçš„ä¸­é—´ç»“æœé›†åˆï¼Œåœ¨æ­¤é›†åˆä¸Šç»§ç»­æ‰§è¡Œåç»­æ­¥éª¤ã€‚

åºåˆ—æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œæ—¶ï¼šåºåˆ—ä¼šå¯¹æ¯ä¸€ä¸ªå…ƒç´ é€ä¸ªæ‰§è¡Œæ‰€æœ‰å¤„ç†æ­¥éª¤ã€‚

å¯è§åºåˆ—å¯é¿å…ç”Ÿæˆä¸­é—´æ­¥éª¤çš„ç»“æœï¼Œä»è€Œæé«˜äº†æ•´ä¸ªé›†åˆå¤„ç†é“¾çš„æ€§èƒ½ã€‚ ä½†æ˜¯ï¼Œåºåˆ—çš„å»¶è¿Ÿæ€§è´¨å¢åŠ äº†ä¸€äº›å¼€é”€ï¼Œè¿™äº›å¼€é”€åœ¨å¤„ç†è¾ƒå°çš„é›†åˆæˆ–è¿›è¡Œæ›´ç®€å•çš„è®¡ç®—
æ—¶å¯èƒ½å¾ˆé‡è¦ã€‚ å› æ­¤ï¼Œåº”è¯¥åŒæ—¶è€ƒè™‘ä½¿ç”¨ Sequence ä¸ Iterableï¼Œå¹¶ç¡®å®šåœ¨å“ªç§æƒ…å†µæ›´é€‚åˆã€‚

æ —å­ ğŸŒ°

å‡å®šæœ‰ä¸€ä¸ªå•è¯åˆ—è¡¨ã€‚è¦æ±‚è¿‡æ»¤é•¿åº¦å¤§äº3ä¸ªå­—ç¬¦çš„å•è¯ï¼Œå¹¶æ‰“å°å‰å››ä¸ªå•è¯çš„é•¿åº¦ã€‚

ä½¿ç”¨é›†åˆæˆ‘ä»¬ä¼šè¿™æ ·åšï¼š

```kotlin
//1ã€å­—ç¬¦ä¸²è½¬list
val words = "The quick brown fox jumps over the lazy dog".split(" ")

//2ã€é›†åˆæ“ä½œä¾æ¬¡æ‰§è¡Œ
val lengthsList = words.filter {
    it.length > 3 // é•¿åº¦å¤§äº3çš„ç­›é€‰å‡ºæ¥ï¼Œç»“æœæ˜¯ä¸€ä¸ªå­é›†åˆã€‚
}
    .map {
        it.length // string é›†åˆè½¬ä¸º inté›†åˆ
    }
    .take(4) //å–inté›†åˆå…ƒç´ å‰4ä¸ª
println("Lengths of first 4 words longer than 3 chars:")
println(lengthsList)
```

![åºåˆ—](https://gitee.com/sunnnydaydev/my-pictures/raw/master/github/kt/Iterable.png)

ä½¿ç”¨åºåˆ—æˆ‘ä»¬ä¼šè¿™æ ·åšï¼š

```kotlin
// 1ã€å­—ç¬¦ä¸²è½¬é›†åˆ
val words = "The quick brown fox jumps over the lazy dog".split(" ")
// 2ã€é›†åˆè½¬æ¢ä¸ºåºåˆ—
val wordsSequence = words.asSequence()

// 3ã€åŒæ ·çš„æ“ä½œï¼Œä¸è¿‡æ¯ä¸ªå…ƒç´ ä¾æ¬¡æ‰§è¡Œä¸‹åˆ—æ“ä½œã€‚
val lengthsSequence = wordsSequence.filter {
    it.length > 3
}
    .map {
        it.length
    }
    .take(4)

println("Lengths of first 4 words longer than 3 chars")
// æœ«ç«¯æ“ä½œï¼šè·å–ç»“æœã€‚
println(lengthsSequence.toList())
```

![åºåˆ—](https://gitee.com/sunnnydaydev/my-pictures/raw/master/github/kt/Sequence.png)

###### 3ã€åºåˆ—ä¸å¼‚æ­¥æµåŒºåˆ«ï¼Ÿ

åºåˆ—æ˜¯åŒæ­¥è®¡ç®—ï¼Œå¼‚æ­¥æµï¼ˆFlowï¼‰æ˜¯å¼‚æ­¥è®¡ç®—ã€‚

###### 4ã€åºåˆ—æ³¨æ„ç‚¹

å¦‚æœåºåˆ—æ“ä½œè¿”å›å»¶è¿Ÿç”Ÿæˆçš„å¦ä¸€ä¸ªåºåˆ—ï¼Œåˆ™ç§°ä¸º ä¸­é—´åºåˆ—ã€‚å¦‚è°ƒç”¨äº†toList()ã€‚

æ²¡æœ‰ç”Ÿæˆæ–°çš„åºåˆ—åˆ™æœ€åçš„æ“ä½œå«æœ«ç«¯æ“ä½œï¼Œå¦‚ mapã€filterã€takeã€dropç­‰ã€‚åªèƒ½é€šè¿‡æœ«ç«¯æ“ä½œæ‰èƒ½æ£€ç´¢åºåˆ—å…ƒç´ ã€‚

# é›†åˆæ“ä½œ

###### 1ã€å…¬å…±æ“ä½œ

å…¬å…±æ“ä½œå¯ç”¨äºåªè¯»é›†åˆä¸å¯å˜é›†åˆ

ï¼ˆ1ï¼‰è½¬æ¢

- map:è½¬åŒ– 
- mapIndexed:è½¬åŒ–ï¼ŒåŒæ—¶lambdaå‚æ•°å¸¦ç´¢å¼•
- mapNotNull()
- mapIndexedNotNull()
- zip:åˆå¹¶ä¸ºPairå¯¹è±¡
- unzip:åˆå¹¶åå‘æ“ä½œ
- associateWith:ç»„åˆ
- associateBy:ç»„åˆ
- flatten:å‹æ‰
- flatMap:å‹æ‰

```kotlin
    // 1ã€mapNotNull æ —å­
    val list  = listOf(1,3,5)
    println("result:${list.mapNotNull { 
        if (it==3){
            "null" 
        }else{
            it
        }
    }}")
    //ç©ºå€¼ä¼šè¢«è¿‡æ»¤æ‰,ç»“æœ1 5

  // 2ã€ zipæ–¹æ³•ï¼šè¿”å›ç»“æœList<Pair<T, R>>
  val colors = listOf("name", "age", "sex")
  val animals = listOf("Carry", "20","boy")
  println(colors.zip(animals)) // ä¸­ç¼€å†™æ³•ä¹Ÿå¯ï¼šcolors zip animals 
  // [(name, Carry), (age, 20), (sex, boy)]
  // æ³¨æ„å½“ä¸¤é›†åˆå…ƒç´ sizeä¸ç­‰æ—¶Listä¼šè¿”å›è¾ƒå°‘é›†åˆçš„sizeä¸ªPairå¯¹


  // 3ã€unzipæ–¹æ³•:zipçš„åå‘æ“ä½œï¼Œè¿”å›ä¸€ä¸ªPairå¯¹è±¡pairçš„key valueæ˜¯ä¸¤ä¸ªé›†åˆï¼ˆPair<List<T>, List<R>>ï¼‰
  val numberPairs = listOf("name" to "Carry", "age" to "20", "sex" to "boy")
  println(numberPairs.unzip())
  // ([name, age, sex], [Carry, 20, boy])

  // 4ã€associateWith ç”Ÿæˆä¸€ä¸ªmapï¼Œkeyä¸ºé›†åˆå…ƒç´ ï¼Œvalueä¸ºlambdaè¡¨è¾¾å¼è¿”å›å€¼    
  val numbers = listOf("one", "two", "three", "four")
  println(numbers.associateWith { 1})
  //{one=1, two=1, three=1, four=1}
  // æ³¨æ„keyå€¼ç›¸ç­‰æ—¶ï¼Œä»…æœ€åä¸€ä¸ªkey-valueå­˜åœ¨mapä¸­å‰é¢çš„ä¼šè¢«èˆå¼ƒ

 // 5ã€associateBy ç”Ÿæˆä¸€ä¸ªmapï¼Œkeyä¸ºlambdaè¡¨è¾¾å¼è¿”å›å€¼ï¼Œvalueå°±æ˜¯listçš„å…ƒç´ 
  println(numbers.associateBy {
     it.first().uppercase()//å–stringçš„æ”¶ä¸ªå­—ç¬¦ä½œä¸ºkey
   })
  //{O=one, T=three, F=four}

   // è¿˜å¯ä»¥åˆ†åˆ«å˜æ¢key value
   println(numbers.associateBy(keySelector = {
        "${it.lowercase()}"
   }, valueTransform = {
        "${it.uppercase()}"
   }))
    //{one=ONE, three=THREE, four=FOUR}

   //6ã€associateï¼šassociate ä¼šç”Ÿæˆä¸´æ—¶çš„ Pair å¯¹è±¡ï¼Œè¿™å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨ã€‚
   val names = listOf("Alice Adams", "Brian Brown", "Clara Campbell")
   println(names.associate {
       Pair(it.first(),it.length)
   })

/***
 * 
7ã€flattenï¼šå‹æ‰ã€‚é€‚ç”¨é›†åˆçš„å…ƒç´ è¿˜æ˜¯é›†åˆçš„é›†åˆï¼Œè¿™ä¸ªapiå¯ä»¥æŠŠå†…å±‚æ‰€æœ‰çš„å°é›†åˆå…ƒç´ åˆå¹¶åˆ°ä¸€ä¸ªé›†åˆä¸­ã€‚å‡½æ•°æºç ï¼š

public fun <T> Iterable<Iterable<T>>.flatten(): List<T> {
   val result = ArrayList<T>()
   for (element in this) {
   result.addAll(element)
   }
    return result
}

 */
val numberSets = listOf(setOf(1, 2, 3), setOf(4, 5, 6), setOf(1, 2))
println(numberSets.flatten())
// [1, 2, 3, 4, 5, 6, 1, 2]

/**
  8ã€flatMap:æ¯”flattenåŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå¯ä»¥çœ‹åšmapä¸flattençš„è¿ç»­è°ƒç”¨ï¼ŒåŒæ ·æ˜¯å…·æœ‰å‹æ‰åŠŸèƒ½ã€‚å‡½æ•°æºç ï¼š
  
  public inline fun <T, R> Iterable<T>.flatMap(transform: (T) -> Iterable<R>): List<R> {
       return flatMapTo(ArrayList<R>(), transform)
  }
  
  
  å¯ä»¥çœ‹åˆ°å‚æ•°æ˜¯lambdaè¡¨è¾¾å¼ï¼Œlambdaå‚æ•°æ˜¯é›†åˆå…ƒç´ ç±»å‹Tï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªé›†åˆï¼Œé›†åˆå…ƒç´ ä¸ºRã€‚å¯è§è¿™é‡Œåšäº†é›†åˆçš„è½¬åŒ–å·¥ä½œã€‚
   
 * */

val allStudent = arrayListOf(
  Student(arrayListOf("æ™®é€šç­:å¼ ä¸‰", "æ™®é€šç­:æå››")),
  Student(arrayListOf("ä¼˜ç§€ç­:carry", "ä¼˜ç§€ç­:kate"))
)

val flatMapResult = allStudent.flatMap {
  it.list
}
println(flatMapResult)
// [æ™®é€šç­:å¼ ä¸‰, æ™®é€šç­:æå››, ä¼˜ç§€ç­:carry, ä¼˜ç§€ç­:kate]

```

flatMap ä¸mapæœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿçœ‹ä¸‹äºŒè€…æºç ï¼š

```kotlin

public inline fun <T, R> Iterable<T>.map(transform: (T) -> R): List<R> {
    return mapTo(ArrayList<R>(collectionSizeOrDefault(10)), transform)
}

public inline fun <T, R> Iterable<T>.flatMap(transform: (T) -> Iterable<R>): List<R> {
  return flatMapTo(ArrayList<R>(), transform)
}
```

æ–¹æ³•ç­¾åçœŸçš„å¾ˆåƒåŒºåˆ«å°±æ˜¯æ–¹æ³•å‚æ•°lambdaè¡¨è¾¾å¼çš„è¿”å›å€¼ä¸åŒï¼Œmapçš„lambdaè¡¨è¾¾å¼çš„è¿”å›å€¼å°±æ˜¯è¦è½¬åŒ–ä¸ºçš„å¯¹è±¡Rï¼Œè€ŒflatMapçš„lambda
è¡¨è¾¾å¼çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªé›†åˆList<R>

è™½ç„¶äºŒè€…æ–¹æ³•çš„è¿”å›å€¼éƒ½æ˜¯List<R>ä½†æ˜¯å…·ä½“çš„å®ç°ç»†èŠ‚æ˜¯ä¸åŒçš„ï¼Œè¿™ç‚¹æˆ‘ä»¬åº”è¯¥èƒ½å¤ŸçŒœåˆ°mapä¸­è‚¯å®šæ˜¯æŠŠç”Ÿæˆçš„Rå…ƒç´ ç›´æ¥addè¿›é›†åˆï¼Œè€ŒflatMap
åˆ™éœ€è¦é€šè¿‡addAllæŠŠIterable<R>åŠ å…¥é›†åˆã€‚

flatMapçš„æ ¸å¿ƒæ€æƒ³è¿˜æ˜¯å±•å¹³ç›®æ ‡é›†åˆã€‚å…¶å¤šäº†ä¸€æ­¥mapæ“ä½œå°±æ˜¯æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå‹æ‰çš„è¿‡ç¨‹ä¸­å¯¹é›†åˆå…ƒç´ è¿›è¡Œè½¬åŒ–ã€‚

ç°åœ¨çœ‹æ¥flattençš„ä½œç”¨æ˜¯ä¸æ˜¯å¤ªå±€é™äº†é›†åˆçš„å…ƒç´ å¿…é¡»æ˜¯é›†åˆå¯¹è±¡ã€‚

(2)è¿‡æ»¤

- filter
- filterIndexed
- filterIsInstance<T>
- filterNotNull
- partition:
- any:è‡³å°‘æœ‰ä¸€ä¸ªåŒ¹é…åˆ™è¿”å›true
- noneï¼šæ²¡æœ‰ä¸€ä¸ªä¸ä¹‹åŒ¹é…åˆ™è¿”å›true
- allï¼šæ‰€æœ‰çš„éƒ½åŒ¹é…åˆ™è¿”å›true

```kotlin
    // 1ã€filterIsInstance è¿‡æ»¤ç‰¹å®šçš„ç±»å‹

    val li = listOf("a","b","c",'d',null,1)
    println(li.filterIsInstance<String>())
    //[a, b, c]
   
   // 2ã€partition
   // partition:å°†liståˆ’åˆ†ä¸ºPairï¼Œç¬¦åˆè§„åˆ™çš„æ”¾å…¥ä¸€ä¸ªé›†åˆï¼Œä¸ç¬¦åˆè§„åˆ™çš„æ”¾å…¥ä¸€ä¸ªé›†åˆã€‚
   // public inline fun <T> Iterable<T>.partition(predicate: (T) -> Boolean): Pair<List<T>, List<T>> 
val partitionList = arrayListOf(1, 2, 3, 4, 5)
val (keyList, valueList) = partitionList.partition {
  it % 2 == 0
}
println(keyList) // [2, 4]
println(valueList)//   [1, 3, 5]
```

# The end

æ›´å¤šé›†åˆæ“ä½œå¯å‚è€ƒè¿™é‡Œ

[é›†åˆæ“ä½œæ¦‚è¿°](https://www.kotlincn.net/docs/reference/collection-operations.html)




